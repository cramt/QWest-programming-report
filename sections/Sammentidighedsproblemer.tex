\chapter{Samtidighedsproblemer}\label{ch:concurrency}
Et samtidighedsproblem opstår når to eller flere operationer foregår parallelt, men hvor rækkefølgen af operationerne er vigtige - dette er også kendt som en Race Condition.\cite{racecondition} Hvis operationerne overskriver samme data, er det vigtigt at vide, hvilken ændring der skal lagres, eller om de begge skal håndteres men i bestemt rækkefølge. Dette kan eksempelvis være to threads, som begge skal inkrementere samme variabel. Hvis Thread A læser variablen først, laver matematisk operation på variablen, og Thread B samtidig læser variablen og laver matematisk operation, kan én af disse operationer "forsvinde" da den ene kan overskrive den anden. Dette er et samtidighedsproblem - rækkefølgen skal følges korrekt for at undgå forsvunde eller undladte operationer.

I dette projekt kan der opstå samtidighedsproblemer når flere brugere skal opdatere et gruppeopslag. Der er i programmet mulighed for at oprette grupper med flere medlemmer, hvor alle medlemmer har adgang til at ændre et gruppeopslag. Hvis flere medlemmer begynder at rette et opslag samtidig, er det ikke umiddelbart klart hvilken ændring, der så skal gemmes. Det skal derfor håndteres sådan at alle samtidige operationer håndteres.


\section{Mulige løsninger}\label{sec:solutions}
Generelt om samtidighedsproblemer er der to tilgange: Pessimistisk eller optimistisk samtidighed. 

Den optimistiske tilgang er primært rettet mod programmer, som kører i lang tid. Ved den optimistiske tilgang bliver data som ændres ikke låst for redigering, men i stedet er det mere vigtigt at vide, hvilken version af data der er tilgået. Flere brugere kan så tilgå det samme data og ændre det samtidig, hvor hver ændring så får tildelt sit eget versionsnummer. Denne versionsstyring kan bruges ved at have et tal i databasen, og metoden er også kaldet Row Versioning\cite{rowversioning}.

Den pessimistiske tilgang betyder at der sættes lås på data så snart det skal ændres, og låsen frigøres først når dataen er ændret færdig. Dette kan være vigtigt ved de transaktioner hvor rækkefølgen af operationerne er meget vigtig, og der foretages kun én ændring ad gangen - eksempelvis ved bank-overførsler. hvis der hæves penge af to instanser fra samme konto samtidigt, er det vigtigt at den første hævning får en lås på kontoen, således at der ikke opstår en dobbelthævning på penge som ikke eksisterer. 


\section{Valgt løsning}\label{sec:chosen_solution}
Den pessimistiske løsning er fravalgt til dette projekt, fordi der kan opstå en situation, hvor en af gruppemedlemmerne begynder at redigere et opslag, så der bliver oprettet en lås på opslaget, hvorefter brugeren lukker deres browser vindue eller computeren. Nu er der en lås, som ikke kan låses op - dette er også kaldet Deadlock\cite{deadlock}. Dette kunne løses ved at implementere en timer eller lignende. 
Det kan godt lade sig gøre at implementere Pessimistisk tilgang ved brug af WebSockets\cite{websockets}, eftersom WebSockets har en konstant forbindelse. Den konstante forbindelse kan derfor oplyse systemet om, hvornår brugeren eksempelvis har lukket browservinduet, som så kunne bruges til at frigøre låsen på opslaget. Dette er dog ikke en god løsning, eftersom WebSockets har states, hvilket går imod RESTful implementationen i dette projekt. Udover dette ville det også være ufordelagtigt at skalere.
Generelt skulle der bruges meget tid på at implementere features som kunne håndtere den Pessimistiske tilgang, samt de problemer der kan opstå. Da dette ikke omhandler livsvigtige data, såsom banknota, eller personlige oplysninger er det fravalgt. 

Der er derfor valgt en optimistisk tilgang, da dette passer bedre til vores projekt, som er bygget på REST principperne. Da det kun er beskrivelsen i opslaget og ikke lokation, billede eller forfattere der skal opdateres, er det besluttet at det ikke er vigtigt at have versionsnummer på hver opdatering. Redigeringsmuligheden er mest tiltænkt rettelser af stavefejl eller hvis man havde glemt at tilføje nogle detaljer til opslaget. Da samtidighedsproblemet kun opstår på gruppeopslag, er der en forventning om at ikke alle i gruppen går ind og retter det samme opslag samtidig alligevel. Såfremt det skulle blive relevant i fremtiden, kunne der indføres versionsnummer eller mulighed for at gruppemedlemmer kan redigere beskrivelsen live sammen, ligesom det gøres i Google Docs. \cite{googledocs}
